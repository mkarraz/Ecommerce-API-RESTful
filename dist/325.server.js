"use strict";exports.id=325,exports.ids=[325],exports.modules={325:(t,e,n)=>{n.r(e),n.d(e,{default:()=>l});var o=n(185),i=n.n(o);const r=new(i().Schema)({name:{type:String,required:!0,minlength:1,maxlength:50},price:{type:Number,required:!0,min:0},description:{type:String,required:!0,minlength:1,maxlength:200},photoURL:{type:String,required:!0,minlength:1,maxlength:200},stock:{type:Number,required:!0,min:0},timestamp:{type:Number,required:!1,default:Date.now}}),s=i().model("products",r);var c=n(456),d=n(826);const u=()=>{return t=void 0,e=void 0,o=function*(){try{yield i().connect(c.Z.MONGO_ATLAS_URL),d.Z.info("Connected to mongoDB Atlas!")}catch(t){d.Z.error(t)}},new((n=void 0)||(n=Promise))((function(i,r){function s(t){try{d(o.next(t))}catch(t){r(t)}}function c(t){try{d(o.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}d((o=o.apply(t,e||[])).next())}));var t,e,n,o};var h=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{d(o.next(t))}catch(t){r(t)}}function c(t){try{d(o.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}d((o=o.apply(t,e||[])).next())}))};class a{constructor(t,e){this.model=t,this.DTO=e,u()}static getInstance(t,e){return this.instance||(this.instance=new a(t,e)),this.instance}getAll(){return h(this,void 0,void 0,(function*(){try{d.Z.info("mongoDBAtlas1");const t=yield this.model.find().lean();return d.Z.info(`mongoDBAtlas2 ${t}`),t.map((t=>new this.DTO(t._id,t.name,t.price,t.description,t.photoURL,t.stock,t.timestamp).toJson()))}catch(t){console.log("Method getAll: ",t)}}))}getById(t){return h(this,void 0,void 0,(function*(){try{const e=yield this.model.findOne({_id:t},{__v:0});return null===e?{error:"Product not found"}:e}catch(t){console.log("Method getById: ",t)}}))}addProduct(t){return h(this,void 0,void 0,(function*(){try{const e=new this.model(t);return yield e.save()}catch(t){console.log("Method add: ",t)}}))}updateProductById(t,e){return h(this,void 0,void 0,(function*(){try{return 0===(yield this.model.updateOne({_id:t},e)).matchedCount?{error:"Product not found."}:{msg:`Product id: ${t} updated!`}}catch(t){console.log("Method update: ",t)}}))}deleteProductById(t){return h(this,void 0,void 0,(function*(){try{return 0===(yield this.model.deleteOne({_id:t})).deletedCount?{error:"Product not found."}:{msg:`Product id: ${t} deleted!`}}catch(t){console.log("Method deleteById: ",t)}}))}}const l=a.getInstance(s,class{constructor(t){this.id=t.id,this.name=t.name,this.price=t.price,this.description=t.description,this.photoURL=t.phptoURL,this.stock=t.stock,this.timestamp=t.timestamp}getId(){return this.id}getName(){return this.name}getPrice(){return this.price}getDescription(){return this.description}getPhotoURL(){return this.photoURL}getStock(){return this.stock}getTimestamp(){return this.timestamp}toJson(){return{id:this.id,name:this.name,price:this.price,description:this.description,photoURL:this.photoURL,stock:this.stock,timestamp:this.timestamp}}})}};